CALL () {
    LOAD CSV WITH HEADERS FROM 'file:///edges_drug_treats.csv' AS row
    WITH row
    WHERE row.drugbank_id IS NOT NULL AND row.drugbank_id <> ''
      AND row.doid        IS NOT NULL AND row.doid        <> ''
    
    MATCH (c:Compound { drugbank_id: row.drugbank_id })
    MATCH (d:Disease  { doid: row.doid })
    
    MERGE (c)-[r:TREATS]->(d)
    SET  r.source   = 'Hetionet',
         r.evidence = row.evidence
} IN TRANSACTIONS OF 1000 ROWS;
